# ======================================================================
# BAGIAN 2: DEKOMPOSISI MATRIKS
# ======================================================================

# ======================================================================
# 1. DEKOMPOSISI LU
# ======================================================================

# Dekomposisi LU memecah matriks A menjadi:
# A = P × L × U
# - P: Permutation matrix
# - L: Lower triangular matrix
# - U: Upper triangular matrix

# --- Matriks A (4×4) ---
# [[4. 3. 2. 1.]
#  [1. 5. 3. 2.]
#  [2. 1. 6. 3.]
#  [1. 2. 3. 7.]]

# --- Hasil Dekomposisi LU ---

# Matriks P (Permutation):
# [[1. 0. 0. 0.]
#  [0. 1. 0. 0.]
#  [0. 0. 1. 0.]
#  [0. 0. 0. 1.]]

# Matriks L (Lower Triangular):
# [[ 1.          0.          0.          0.        ]
#  [ 0.25        1.          0.          0.        ]
#  [ 0.5        -0.11764706  1.          0.        ]
#  [ 0.25        0.29411765  0.33333333  1.        ]]

# Matriks U (Upper Triangular):
# [[4.         3.         2.         1.        ]
#  [0.         4.25       2.5        1.75      ]
#  [0.         0.         5.29411765 2.70588235]
#  [0.         0.         0.         5.33333333]]

# --- Verifikasi: P × L × U = A ---
# P × L × U =
# [[4. 3. 2. 1.]
#  [1. 5. 3. 2.]
#  [2. 1. 6. 3.]
#  [1. 2. 3. 7.]]

# Matriks A (original):
# [[4. 3. 2. 1.]
#  [1. 5. 3. 2.]
#  [2. 1. 6. 3.]
#  [1. 2. 3. 7.]]

# Apakah P×L×U = A? True
# Maksimum error: 0.00e+00

# --- Aplikasi: Menyelesaikan SPL dengan LU ---
# Vektor b: [10. 15. 20. 25.]

# Solusi x: [0.33333333 0.83333333 1.83333333 2.5       ]
# Verifikasi A×x: [10. 15. 20. 25.]
# b: [10. 15. 20. 25.]
# Benar? True


# ======================================================================
# 2. DEKOMPOSISI QR
# ======================================================================

# Dekomposisi QR memecah matriks A menjadi:
# A = Q × R
# - Q: Orthogonal matrix (Q^T × Q = I)
# - R: Upper triangular matrix

# --- Matriks B (4×4) ---
# [[ 12.   6.  -4.   2.]
#  [-51. 167.  24.   8.]
#  [  4. -68. -41.  10.]
#  [  2.   3.   5.  15.]]

# --- Hasil Dekomposisi QR ---

# Matriks Q (Orthogonal):
# [[-0.22820948 -0.61253378 -0.75627332 -0.02781126]
#  [ 0.96989028 -0.08847002 -0.22262704  0.04385312]
#  [-0.07606983  0.77463611 -0.60992438  0.14881041]
#  [-0.03803491 -0.13005508  0.0804992   0.98750134]]

# Matriks R (Upper Triangular):
# [[-52.5832673  165.66106382  27.11889301   5.97148135]
#  [  0.         -71.51511683 -32.08350117   3.86270715]
#  [  0.           0.          23.09143985  -8.1853187 ]
#  [  0.           0.           0.          16.59582664]]

# --- Verifikasi 1: Q × R = B ---
# Q × R =
# [[ 12.   6.  -4.   2.]
#  [-51. 167.  24.   8.]
#  [  4. -68. -41.  10.]
#  [  2.   3.   5.  15.]]

# Matriks B (original):
# [[ 12.   6.  -4.   2.]
#  [-51. 167.  24.   8.]
#  [  4. -68. -41.  10.]
#  [  2.   3.   5.  15.]]

# Apakah Q×R = B? True
# Maksimum error: 2.84e-14

# --- Verifikasi 2: Q^T × Q = I ---
# Q^T × Q =
# [[ 1.00000000e+00 -2.30521857e-17 -8.64929205e-17 -1.53387665e-17]
#  [-2.30521857e-17  1.00000000e+00  1.22842200e-16 -2.46325079e-18]
#  [-8.64929205e-17  1.22842200e-16  1.00000000e+00 -3.21019007e-17]
#  [-1.53387665e-17 -2.46325079e-18 -3.21019007e-17  1.00000000e+00]]

# Identity Matrix I:
# [[1. 0. 0. 0.]
#  [0. 1. 0. 0.]
#  [0. 0. 1. 0.]
#  [0. 0. 0. 1.]]

# Apakah Q^T×Q = I? True
# Maksimum error: 4.44e-16

# --- Aplikasi: Least Squares Problem ---
# Mencari solusi x yang meminimalkan ||Bx - c||
# Vektor c: [10. 20. 30. 40.]

# Solusi least squares x: [ 0.26069597  0.1025672  -0.22145522  2.68521217]
# Residual B×x - c: [1.77635684e-15 7.10542736e-15 0.00000000e+00 7.10542736e-15]
# Norm residual: 0.000000


# ======================================================================
# 3. EIGENVALUE dan EIGENVECTOR
# ======================================================================

# Eigenvalue λ dan eigenvector v memenuhi:
# A × v = λ × v

# --- Matriks C (4×4, Simetris) ---
# [[4. 2. 1. 0.]
#  [2. 5. 3. 1.]
#  [1. 3. 6. 2.]
#  [0. 1. 2. 3.]]

# --- Eigenvalues ---
# λ_1 = 9.936323
# λ_2 = 4.232963
# λ_3 = 2.000000
# λ_4 = 1.830714

# --- Eigenvectors ---
# (Setiap kolom adalah satu eigenvector)
# [[-3.16149758e-01 -7.36397963e-01 -5.77350269e-01 -1.56313906e-01]
#  [-5.98455878e-01 -2.95551470e-01  5.77350269e-01  4.70283486e-01]
#  [-6.79855240e-01  4.19549447e-01 -4.52629939e-16 -6.01477443e-01]
#  [-2.82306120e-01  4.40846493e-01 -5.77350269e-01  6.26597391e-01]]

# --- Verifikasi: A × v_i = λ_i × v_i ---

# Eigenpair 1:
# λ_1 = 9.936323
# v_1 = [-0.31614976 -0.59845588 -0.67985524 -0.28230612]
# A × v_1 = [-3.14136603 -5.94645075 -6.75526107 -2.80508472]
# λ_1 × v_1 = [-3.14136603 -5.94645075 -6.75526107 -2.80508472]
# Sama? True
# Error: 2.55e-15

# Eigenpair 2:
# λ_2 = 4.232963
# v_2 = [-0.73639796 -0.29555147  0.41954945  0.44084649]
# A × v_2 = [-3.11714535 -1.25105844  1.77593729  1.8660869 ]
# λ_2 × v_2 = [-3.11714535 -1.25105844  1.77593729  1.8660869 ]
# Sama? True
# Error: 3.07e-15

# Eigenpair 3:
# λ_3 = 2.000000
# v_3 = [-5.77350269e-01  5.77350269e-01 -4.52629939e-16 -5.77350269e-01]
# A × v_3 = [-1.15470054e+00  1.15470054e+00 -1.44328993e-15 -1.15470054e+00]
# λ_3 × v_3 = [-1.15470054e+00  1.15470054e+00 -9.05259879e-16 -1.15470054e+00]
# Sama? True
# Error: 2.09e-15

# Eigenpair 4:
# λ_4 = 1.830714
# v_4 = [-0.15631391  0.47028349 -0.60147744  0.62659739]
# A × v_4 = [-0.28616609  0.86095468 -1.10113333  1.14712077]
# λ_4 × v_4 = [-0.28616609  0.86095468 -1.10113333  1.14712077]
# Sama? True
# Error: 3.33e-16

# --- Diagonalisasi: C = V × D × V^(-1) ---

# Matriks D (Diagonal dari eigenvalues):
# [[9.93632273 0.         0.         0.        ]
#  [0.         4.23296302 0.         0.        ]
#  [0.         0.         2.         0.        ]
#  [0.         0.         0.         1.83071425]]

# Matriks V (Eigenvectors):
# [[-3.16149758e-01 -7.36397963e-01 -5.77350269e-01 -1.56313906e-01]
#  [-5.98455878e-01 -2.95551470e-01  5.77350269e-01  4.70283486e-01]
#  [-6.79855240e-01  4.19549447e-01 -4.52629939e-16 -6.01477443e-01]
#  [-2.82306120e-01  4.40846493e-01 -5.77350269e-01  6.26597391e-01]]

# V × D × V^(-1) =
# [[ 4.00000000e+00  2.00000000e+00  1.00000000e+00 -5.51015299e-16]
#  [ 2.00000000e+00  5.00000000e+00  3.00000000e+00  1.00000000e+00]
#  [ 1.00000000e+00  3.00000000e+00  6.00000000e+00  2.00000000e+00]
#  [-2.00332142e-16  1.00000000e+00  2.00000000e+00  3.00000000e+00]]

# Matriks C (original):
# [[4. 2. 1. 0.]
#  [2. 5. 3. 1.]
#  [1. 3. 6. 2.]
#  [0. 1. 2. 3.]]

# Apakah V×D×V^(-1) = C? True
# Maksimum error: 2.89e-15

# --- Aplikasi: Menghitung C^10 dengan Eigendecomposition ---

# C^10 (menggunakan eigendecomposition):
# [[9.38655866e+08 1.77533425e+09 2.01578069e+09 8.36679410e+08]
#  [1.77533425e+09 3.36002162e+09 3.81662423e+09 1.58468635e+09]
#  [2.01578069e+09 3.81662423e+09 4.33633037e+09 1.80084353e+09]
#  [8.36679410e+08 1.58468635e+09 1.80084353e+09 7.48007961e+08]]

# C^10 (perhitungan langsung):
# [[9.38655866e+08 1.77533425e+09 2.01578069e+09 8.36679410e+08]
#  [1.77533425e+09 3.36002162e+09 3.81662423e+09 1.58468635e+09]
#  [2.01578069e+09 3.81662423e+09 4.33633037e+09 1.80084353e+09]
#  [8.36679410e+08 1.58468635e+09 1.80084353e+09 7.48007961e+08]]

# Hasil sama? True
# Maksimum error: 1.14e-05

# ======================================================================
# BAGIAN 2 SELESAI
# ======================================================================