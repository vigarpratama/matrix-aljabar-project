# ======================================================================
# BAGIAN 2: DEKOMPOSISI MATRIKS
# ======================================================================

# ======================================================================
# 1. DEKOMPOSISI LU
# ======================================================================

# Dekomposisi LU memecah matriks A menjadi:
# A = P × L × U
# - P: Permutation matrix
# - L: Lower triangular matrix
# - U: Upper triangular matrix

# --- Matriks A (4×4) ---
# [[4. 3. 2. 1.]
#  [1. 5. 3. 2.]
#  [2. 1. 6. 3.]
#  [1. 2. 3. 7.]]

# --- Hasil Dekomposisi LU ---

# Matriks P (Permutation):
# [[1. 0. 0. 0.]
#  [0. 1. 0. 0.]
#  [0. 0. 1. 0.]
#  [0. 0. 0. 1.]]

# Matriks L (Lower Triangular):
# [[1.         0.         0.         0.        ]
#  [0.25       1.         0.         0.        ]
#  [0.5        0.04651163 1.         0.        ]
#  [0.25       0.27906977 0.36538462 1.        ]]

# Matriks U (Upper Triangular):
# [[4.         3.         2.         1.        ]
#  [0.         4.25       2.5        1.75      ]
#  [0.         0.         4.88372093 2.02325581]
#  [0.         0.         0.         5.76923077]]

# --- Verifikasi: P × L × U = A ---
# P × L × U =
# [[4. 3. 2. 1.]
#  [1. 5. 3. 2.]
#  [2. 1. 6. 3.]
#  [1. 2. 3. 7.]]

# Matriks A (original):
# [[4. 3. 2. 1.]
#  [1. 5. 3. 2.]
#  [2. 1. 6. 3.]
#  [1. 2. 3. 7.]]

# Apakah P×L×U = A? True
# Maksimum error: 0.00e+00

# --- Aplikasi: Menyelesaikan SPL dengan LU ---
# Vektor b: [10. 15. 20. 25.]

# Solusi x: [0.56410256 1.11538462 1.52564103 2.48717949]

# Verifikasi A×x: [10. 15. 20. 25.]
# b: [10. 15. 20. 25.]
# Benar? True


# ======================================================================
# 2. DEKOMPOSISI QR
# ======================================================================

# Dekomposisi QR memecah matriks A menjadi:
# A = Q × R
# - Q: Orthogonal matrix (Q^T × Q = I)
# - R: Upper triangular matrix

# --- Matriks B (4×4) ---
# [[ 12.   6.  -4.   2.]
#  [-51. 167.  24.   8.]
#  [  4. -68. -41.  10.]
#  [  2.   3.   5.  15.]]

# --- Hasil Dekomposisi QR ---

# Matriks Q (Orthogonal):
# [[-0.22857143  0.14444444 -0.18814815 -0.94444444]
#  [ 0.97142857  0.18518519 -0.14074074  0.        ]
#  [-0.07619048 -0.96296296 -0.25925926  0.        ]
#  [-0.03809524 -0.01851852  0.93333333 -0.33333333]]

# Matriks R (Upper Triangular):
# [[-52.5        -175.          -27.5         -10.5       ]
#  [  0.          -64.37037037  -39.48148148   -7.37037037]
#  [  0.            0.           11.7037037    12.2962963 ]
#  [  0.            0.            0.           13.        ]]

# --- Verifikasi 1: Q × R = B ---
# Q × R =
# [[ 12.   6.  -4.   2.]
#  [-51. 167.  24.   8.]
#  [  4. -68. -41.  10.]
#  [  2.   3.   5.  15.]]

# Matriks B (original):
# [[ 12.   6.  -4.   2.]
#  [-51. 167.  24.   8.]
#  [  4. -68. -41.  10.]
#  [  2.   3.   5.  15.]]

# Apakah Q×R = B? True
# Maksimum error: 7.11e-15

# --- Verifikasi 2: Q^T × Q = I ---
# Q^T × Q =
# [[ 1.00000000e+00 -5.55111512e-17  2.77555756e-17  0.00000000e+00]
#  [-5.55111512e-17  1.00000000e+00 -1.11022302e-16  0.00000000e+00]
#  [ 2.77555756e-17 -1.11022302e-16  1.00000000e+00  0.00000000e+00]
#  [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.00000000e+00]]

# Identity Matrix I:
# [[1. 0. 0. 0.]
#  [0. 1. 0. 0.]
#  [0. 0. 1. 0.]
#  [0. 0. 0. 1.]]

# Apakah Q^T×Q = I? True
# Maksimum error: 1.11e-16

# --- Aplikasi: Least Squares Problem ---
# Mencari solusi x yang meminimalkan ||Bx - c||
# Vektor c: [10. 20. 30. 40.]

# Solusi least squares x: [-0.00571429 -0.11428571  0.82857143  3.08571429]

# Residual B×x - c: [-1.77635684e-15  0.00000000e+00  0.00000000e+00 -3.55271368e-15]
# Norm residual: 0.000000


# ======================================================================
# 3. EIGENVALUE dan EIGENVECTOR
# ======================================================================

# Eigenvalue λ dan eigenvector v memenuhi:
# A × v = λ × v

# --- Matriks C (4×4, Simetris) ---
# [[4. 2. 1. 0.]
#  [2. 5. 3. 1.]
#  [1. 3. 6. 2.]
#  [0. 1. 2. 3.]]

# --- Eigenvalues ---
# λ_1 = 10.635531
# λ_2 = 5.206556
# λ_3 = 1.663896
# λ_4 = 0.494017

# --- Eigenvectors ---
# (Setiap kolom adalah satu eigenvector)
# [[-0.32357589 -0.59267263  0.58350578  0.44932175]
#  [-0.50663846 -0.41805717 -0.59542857 -0.45996311]
#  [-0.60458918  0.03759332 -0.39858486  0.68998908]
#  [-0.52225664  0.68834568  0.38338711 -0.33021997]]

# --- Verifikasi: A × v_i = λ_i × v_i ---

# Eigenpair 1:
# λ_1 = 10.635531
# v_1 = [-0.32357589 -0.50663846 -0.60458918 -0.52225664]
# A × v_1 = [-3.44077868 -5.38879698 -6.43095683 -5.55398966]
# λ_1 × v_1 = [-3.44077868 -5.38879698 -6.43095683 -5.55398966]
# Sama? True
# Error: 6.99e-15

# Eigenpair 2:
# λ_2 = 5.206556
# v_2 = [-0.59267263 -0.41805717  0.03759332  0.68834568]
# A × v_2 = [-3.08575001 -2.17653832  0.19575156  3.58402686]
# λ_2 × v_2 = [-3.08575001 -2.17653832  0.19575156  3.58402686]
# Sama? True
# Error: 5.71e-15

# Eigenpair 3:
# λ_3 = 1.663896
# v_3 = [ 0.58350578 -0.59542857 -0.39858486  0.38338711]
# A × v_3 = [ 0.97087044 -0.99068516 -0.66311668  0.63791663]
# λ_3 × v_3 = [ 0.97087044 -0.99068516 -0.66311668  0.63791663]
# Sama? True
# Error: 2.38e-15

# Eigenpair 4:
# λ_4 = 0.494017
# v_4 = [ 0.44932175 -0.45996311  0.68998908 -0.33021997]
# A × v_4 = [ 0.22194831 -0.22720458  0.34085021 -0.16317083]
# λ_4 × v_4 = [ 0.22194831 -0.22720458  0.34085021 -0.16317083]
# Sama? True
# Error: 1.94e-16

# --- Diagonalisasi: C = V × D × V^(-1) ---

# Matriks D (Diagonal dari eigenvalues):
# [[10.63553084  0.          0.          0.        ]
#  [ 0.          5.20655625  0.          0.        ]
#  [ 0.          0.          1.66389583  0.        ]
#  [ 0.          0.          0.          0.49401709]]

# Matriks V (Eigenvectors):
# [[-0.32357589 -0.59267263  0.58350578  0.44932175]
#  [-0.50663846 -0.41805717 -0.59542857 -0.45996311]
#  [-0.60458918  0.03759332 -0.39858486  0.68998908]
#  [-0.52225664  0.68834568  0.38338711 -0.33021997]]

# V × D × V^(-1) =
# [[4. 2. 1. 0.]
#  [2. 5. 3. 1.]
#  [1. 3. 6. 2.]
#  [0. 1. 2. 3.]]

# Matriks C (original):
# [[4. 2. 1. 0.]
#  [2. 5. 3. 1.]
#  [1. 3. 6. 2.]
#  [0. 1. 2. 3.]]

# Apakah V×D×V^(-1) = C? True
# Maksimum error: 1.78e-15

# --- Aplikasi: Menghitung C^10 dengan Eigendecomposition ---

# C^10 (menggunakan eigendecomposition):
# [[1.77726976e+10 3.04699686e+10 2.64668858e+10 1.97800527e+10]
#  [3.04699686e+10 5.23146877e+10 4.54494419e+10 3.39715035e+10]
#  [2.64668858e+10 4.54494419e+10 3.95135327e+10 2.95400091e+10]
#  [1.97800527e+10 3.39715035e+10 2.95400091e+10 2.20777982e+10]]

# C^10 (perhitungan langsung):
# [[1.77726976e+10 3.04699686e+10 2.64668858e+10 1.97800527e+10]
#  [3.04699686e+10 5.23146877e+10 4.54494419e+10 3.39715035e+10]
#  [2.64668858e+10 4.54494419e+10 3.95135327e+10 2.95400091e+10]
#  [1.97800527e+10 3.39715035e+10 2.95400091e+10 2.20777982e+10]]

# Hasil sama? True
# Maksimum error: 1.16e-02

# ======================================================================
# BAGIAN 2 SELESAI
# ======================================================================
